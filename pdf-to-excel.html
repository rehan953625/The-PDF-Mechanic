<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <title>Convert PDF to Excel Free (Offline) | Extract Tables to XLSX</title>
    <meta name="description" content="Convert PDF to Excel (XLSX) instantly without uploading files. Best tool to extract tables from bank statements and invoices. 100% Secure & Client-side.">
    <meta name="keywords" content="pdf to excel converter offline, extract table from pdf to excel, convert bank statement to excel free, pdf to xlsx converter, client side pdf tools">
    <meta name="author" content="The PDF Mechanic" />
    <link rel="canonical" href="https://www.thepdfmechanic.com/pdf-to-excel.html" />
    
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <meta name="theme-color" content="#2563eb">

    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: 'class', 
        theme: {
          extend: {
            colors: { 
                brand: { 50: '#eff6ff', 100: '#dbeafe', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8', 900: '#1e3a8a' },
                excel: { 50: '#f0fdf4', 100: '#dcfce7', 600: '#16a34a' }, // Specific for this tool
                dark: { bg: '#0f172a', card: '#1e293b', text: '#f8fafc', border: '#334155' } 
            },
            fontFamily: { sans: ['Inter', 'sans-serif'], display: ['Outfit', 'sans-serif'] },
            animation: { 'fade-in': 'fadeIn 0.5s ease-out' },
            keyframes: { fadeIn: { '0%': { opacity: '0', transform: 'translateY(10px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } } }
          }
        }
      }
    </script>
    <style>
        .glass-nav { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(12px); }
        .dark .glass-nav { background: rgba(15, 23, 42, 0.9); }
    </style>
</head>
<body class="font-sans bg-slate-50 text-slate-900 dark:bg-dark-bg dark:text-dark-text flex flex-col min-h-screen selection:bg-brand-500 selection:text-white transition-colors duration-300">

    <nav class="sticky top-0 z-50 glass-nav border-b border-slate-200 dark:border-dark-border transition-colors">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex h-16 items-center justify-between">
          <a href="index.html" class="flex items-center gap-2 group">
            <div class="w-9 h-9 bg-brand-600 rounded-lg flex items-center justify-center text-white text-lg shadow-lg group-hover:bg-brand-700 transition">
                <i class="fa-solid fa-wrench"></i>
            </div>
            <span class="font-display font-bold text-xl tracking-tight">The PDF Mechanic</span>
          </a>
          
          <div class="flex items-center gap-5">
             <div class="hidden md:flex gap-6 text-sm font-medium">
                <a href="index.html#tools-section" class="hover:text-brand-600 dark:hover:text-brand-400 transition">All Tools</a>
                <a href="#how-to-use" class="hover:text-brand-600 dark:hover:text-brand-400 transition">Guide</a>
            </div>
            <button id="themeToggle" class="w-10 h-10 rounded-full bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-yellow-400 flex items-center justify-center transition hover:ring-2 ring-brand-500">
                <i class="fa-solid fa-moon dark:hidden"></i>
                <i class="fa-solid fa-sun hidden dark:block"></i>
            </button>
          </div>
        </div>
      </div>
    </nav>

    <header class="relative pt-16 pb-12 text-center px-4">
        <div class="max-w-3xl mx-auto">
            <div class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-excel-50 dark:bg-green-900/30 text-excel-600 dark:text-green-300 text-xs font-semibold mb-6 border border-excel-100 dark:border-green-800">
                <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span> Offline Mode & Secure
            </div>
            <h1 class="font-display text-4xl sm:text-5xl font-extrabold leading-tight mb-6 text-slate-900 dark:text-white">
                Convert PDF to <span class="text-excel-600">Excel (XLSX)</span>
            </h1>
            <p class="text-lg text-slate-600 dark:text-slate-400 mb-8 max-w-2xl mx-auto">
                Extract tables from Bank Statements and Invoices directly in your browser. No file upload required.
            </p>
        </div>
    </header>

    <main class="flex-grow px-4 pb-20">
        <div class="max-w-4xl mx-auto bg-white dark:bg-dark-card rounded-3xl shadow-xl border border-slate-200 dark:border-dark-border overflow-hidden">
            
            <div id="uploadStep" class="p-10 text-center border-b border-slate-100 dark:border-slate-800">
                <div class="w-20 h-20 bg-excel-50 dark:bg-green-900/20 text-excel-600 rounded-full flex items-center justify-center text-4xl mx-auto mb-6">
                    <i class="fa-solid fa-file-csv"></i>
                </div>
                <h3 class="text-xl font-bold mb-2 text-slate-900 dark:text-white">Select PDF File</h3>
                <p class="text-slate-500 text-sm mb-6">We support Bank Statements, Invoices & Data Tables.</p>
                
                <input type="file" id="uploadInput" accept="application/pdf" class="hidden">
                <button onclick="document.getElementById('uploadInput').click()" class="bg-excel-600 hover:bg-green-700 text-white font-semibold py-3 px-8 rounded-xl shadow-lg shadow-green-500/30 transition-all hover:-translate-y-1">
                    Choose PDF Document
                </button>
            </div>

            <div id="processingStep" class="hidden p-12 text-center">
                <div class="animate-spin w-12 h-12 border-4 border-excel-100 border-t-excel-600 rounded-full mx-auto mb-4"></div>
                <h3 class="text-xl font-bold mb-2 text-slate-900 dark:text-white">Analyzing Data Structures...</h3>
                <p class="text-sm text-slate-500" id="progressText">Reading pages...</p>
            </div>

            <div id="downloadStep" class="hidden p-10 text-center bg-excel-50 dark:bg-green-900/10">
                <div class="w-16 h-16 bg-white dark:bg-dark-card text-excel-600 rounded-full flex items-center justify-center text-3xl mx-auto mb-4 shadow-sm">
                    <i class="fa-solid fa-check"></i>
                </div>
                <h3 class="text-2xl font-bold mb-2 text-slate-900 dark:text-white">Conversion Successful!</h3>
                <p class="text-slate-600 dark:text-slate-400 mb-8">Your spreadsheet is ready for download.</p>
                
                <button id="downloadBtn" class="bg-excel-600 hover:bg-green-700 text-white font-bold py-4 px-10 rounded-xl shadow-xl shadow-green-500/30 transition-all hover:-translate-y-1 flex items-center justify-center gap-3 mx-auto">
                    <i class="fa-solid fa-download"></i> Download Excel File
                </button>
                <br>
                <button onclick="location.reload()" class="text-sm text-slate-500 hover:text-excel-600 mt-6 underline">Convert Another File</button>
            </div>

        </div>
    </main>

    <section id="how-to-use" class="max-w-4xl mx-auto px-4 pb-20">
        <div class="prose prose-slate dark:prose-invert max-w-none">
            
            <h2 class="text-3xl font-display font-bold mb-6 text-slate-900 dark:text-white">How to Convert PDF to Excel Without Uploading (Secure Way)</h2>
            <p class="text-lg leading-relaxed text-slate-600 dark:text-slate-400 mb-6">
                Handling financial documents like <strong>Bank Statements, Invoices, or Balance Sheets</strong> requires strict security. Most online converters ask you to upload your sensitive files to their cloud servers. This creates a privacy risk.
            </p>
            <p class="mb-6 text-slate-600 dark:text-slate-400">
                <strong>The PDF Mechanic</strong> solves this problem. Our <em>PDF to Excel Converter</em> runs entirely in your browser using JavaScript. This means your file never leaves your computer, making it the safest way to extract tables from PDF to Excel for free.
            </p>

            <h3 class="text-2xl font-bold mb-4 mt-8 text-slate-900 dark:text-white">Why Choose Client-Side Conversion?</h3>
            <div class="grid md:grid-cols-2 gap-6 my-6">
                <div class="bg-white dark:bg-dark-card p-6 rounded-xl border border-slate-200 dark:border-slate-700">
                    <h4 class="font-bold flex items-center gap-2 mb-2 text-slate-900 dark:text-white"><i class="fa-solid fa-lock text-excel-600"></i> 100% Privacy</h4>
                    <p class="text-sm text-slate-500">Your data is processed locally. Even if you disconnect the internet after loading the page, the tool will still work.</p>
                </div>
                <div class="bg-white dark:bg-dark-card p-6 rounded-xl border border-slate-200 dark:border-slate-700">
                    <h4 class="font-bold flex items-center gap-2 mb-2 text-slate-900 dark:text-white"><i class="fa-solid fa-bolt text-yellow-500"></i> No Waiting</h4>
                    <p class="text-sm text-slate-500">Since there is no uploading or downloading from a server, the conversion happens instantly.</p>
                </div>
            </div>

            <h3 class="text-2xl font-bold mb-4 text-slate-900 dark:text-white">Step-by-Step Guide to Extract Tables</h3>
            <ol class="list-decimal pl-5 space-y-3 mb-8 text-slate-700 dark:text-slate-300">
                <li><strong>Select your File:</strong> Click on the "Choose PDF Document" button above.</li>
                <li><strong>Auto-Analysis:</strong> Our smart algorithm scans the PDF for text coordinates. It identifies rows based on vertical positioning and columns based on horizontal gaps.</li>
                <li><strong>Download XLSX:</strong> Once processing is done, click "Download Excel File". The file is compatible with Microsoft Excel, Google Sheets, and LibreOffice.</li>
            </ol>

            <div class="bg-brand-50 dark:bg-brand-900/20 p-6 rounded-xl border border-brand-100 dark:border-brand-800 my-8">
                <h4 class="font-bold text-brand-700 dark:text-brand-300 mb-2">More PDF Tools You Might Need</h4>
                <ul class="space-y-2 text-sm text-brand-800 dark:text-brand-200">
                    <li><i class="fa-solid fa-arrow-right mr-2"></i> File too big? Use our <a href="compressor.html" class="underline font-semibold hover:text-brand-600">PDF Compressor (100kb)</a> before converting.</li>
                    <li><i class="fa-solid fa-arrow-right mr-2"></i> Have multiple statements? <a href="merger.html" class="underline font-semibold hover:text-brand-600">Merge PDF Files</a> into one before extracting data.</li>
                    <li><i class="fa-solid fa-arrow-right mr-2"></i> Need editable text? Try our <a href="pdf-to-word.html" class="underline font-semibold hover:text-brand-600">PDF to Word Converter</a> for easy editing.</li>
                </ul>
            </div>

            <h3 class="text-2xl font-bold mb-4 text-slate-900 dark:text-white">Frequently Asked Questions</h3>
            <div class="space-y-4">
                <details class="group bg-white dark:bg-dark-card border border-slate-200 dark:border-dark-border rounded-lg p-4 cursor-pointer">
                    <summary class="font-bold text-slate-800 dark:text-slate-200 list-none flex justify-between items-center">
                        Does this tool work on Scanned PDFs?
                        <span class="transition group-open:rotate-180"><i class="fa-solid fa-chevron-down"></i></span>
                    </summary>
                    <p class="text-slate-600 dark:text-slate-400 mt-3 text-sm">
                        Currently, this tool extracts data from "Selectable Text" PDFs (like digital invoices). For scanned images, you will need an OCR tool, which we are adding soon.
                    </p>
                </details>
                <details class="group bg-white dark:bg-dark-card border border-slate-200 dark:border-dark-border rounded-lg p-4 cursor-pointer">
                    <summary class="font-bold text-slate-800 dark:text-slate-200 list-none flex justify-between items-center">
                        Is there a page limit?
                        <span class="transition group-open:rotate-180"><i class="fa-solid fa-chevron-down"></i></span>
                    </summary>
                    <p class="text-slate-600 dark:text-slate-400 mt-3 text-sm">
                        Since the processing happens on your device (laptop/mobile), the limit depends on your device's RAM. Usually, files up to 50-100 pages are processed easily within seconds.
                    </p>
                </details>
            </div>

        </div>
    </section>

    <footer class="bg-slate-950 text-slate-400 pt-16 pb-8 border-t border-slate-800">
        <div class="max-w-7xl mx-auto px-4 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-10 mb-10">
            <div class="col-span-1 sm:col-span-2 md:col-span-1">
                <div class="flex items-center gap-2 mb-4 text-white">
                    <i class="fa-solid fa-wrench text-brand-600 text-xl"></i>
                    <span class="font-bold text-xl font-display">The PDF Mechanic</span>
                </div>
                <p class="text-sm leading-relaxed text-slate-500 mb-6">
                    Built for speed and privacy. The only PDF toolkit that works 100% offline in your browser.
                </p>
                <div class="text-xs font-bold text-slate-600 uppercase tracking-wider mb-3 flex items-center gap-2">
                    
                </div>
            </div>
            
            <div>
                <h4 class="text-white font-bold text-sm mb-4">Tools</h4>
                <ul class="space-y-2 text-sm">
                    <li><a href="compressor.html" class="hover:text-brand-500 transition">Compress PDF</a></li>
                    <li><a href="merger.html" class="hover:text-brand-500 transition">Merge PDF</a></li>
                    <li><a href="ocr.html" class="hover:text-brand-500 transition">OCR Scans</a></li>
                </ul>
            </div>

            <div>
                <h4 class="text-white font-bold text-sm mb-4">Convert</h4>
                <ul class="space-y-2 text-sm">
                    <li><a href="pdf-to-word.html" class="hover:text-brand-500 transition">PDF to Word</a></li>
                    <li><a href="images-to-pdf.html" class="hover:text-brand-500 transition">JPG to PDF</a></li>
                    <li><a href="excel-to-pdf.html" class="hover:text-brand-500 transition">Excel to PDF</a></li>
                </ul>
            </div>

            <div>
                <h4 class="text-white font-bold text-sm mb-4">Legal</h4>
                <ul class="space-y-2 text-sm">
                    <li><a href="privacy.html" class="hover:text-brand-500 transition">Privacy Policy</a></li>
                    <li><a href="terms.html" class="hover:text-brand-500 transition">Terms of Use</a></li>
                    <li><a href="sitemap.xml" class="hover:text-brand-500 transition">Sitemap</a></li>
                </ul>
            </div>
        </div>
        
        <div class="border-t border-slate-900 pt-8 text-center text-xs text-slate-600 px-4">
            &copy; <span id="year"></span> The PDF Mechanic. All rights reserved.
        </div>
    </footer>

    <script>
        // 1. Theme Logic
        const themeToggle = document.getElementById('themeToggle');
        const html = document.documentElement;
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            html.classList.add('dark');
        }
        themeToggle.addEventListener('click', () => {
            html.classList.toggle('dark');
            localStorage.theme = html.classList.contains('dark') ? 'dark' : 'light';
        });
        document.getElementById('year').textContent = new Date().getFullYear();

        // 2. CONVERTER LOGIC
        const uploadInput = document.getElementById('uploadInput');
        const uploadStep = document.getElementById('uploadStep');
        const processingStep = document.getElementById('processingStep');
        const downloadStep = document.getElementById('downloadStep');
        const progressText = document.getElementById('progressText');
        const downloadBtn = document.getElementById('downloadBtn');

        let excelWorkbook = null;
        let originalFileName = "";

        uploadInput.addEventListener('change', async function(e) {
            if(e.target.files.length === 0) return;
            
            const file = e.target.files[0];
            originalFileName = file.name.replace('.pdf', '');
            
            // UI Switch
            uploadStep.classList.add('hidden');
            processingStep.classList.remove('hidden');

            try {
                const arrayBuffer = await file.arrayBuffer();
                const pdf = await pdfjsLib.getDocument(arrayBuffer).promise;
                
                let fullTableData = [];
                const totalPages = pdf.numPages;
                let hasText = false;

                for (let i = 1; i <= totalPages; i++) {
                    progressText.innerText = `Analyzing Page ${i} of ${totalPages}...`;
                    
                    const page = await pdf.getPage(i);
                    const textContent = await page.getTextContent();
                    
                    if (textContent.items.length > 0) hasText = true;

                    // Filter & Map Items
                    let items = textContent.items
                        .filter(item => item.str.trim().length > 0)
                        .map(item => ({
                            text: item.str,
                            x: item.transform[4],
                            y: item.transform[5]
                        }));

                    // Sort by Y (Top to Bottom)
                    items.sort((a, b) => b.y - a.y);

                    // Row Clustering (Tolerance: 10px)
                    let currentRow = [];
                    let currentY = items.length > 0 ? items[0].y : 0;
                    let pageRows = [];

                    items.forEach(item => {
                        if (Math.abs(item.y - currentY) < 10) { 
                            currentRow.push(item);
                        } else {
                            if (currentRow.length > 0) {
                                // Sort Row X (Left to Right)
                                currentRow.sort((a, b) => a.x - b.x);
                                pageRows.push(currentRow.map(c => c.text));
                            }
                            currentRow = [item];
                            currentY = item.y;
                        }
                    });

                    if (currentRow.length > 0) {
                        currentRow.sort((a, b) => a.x - b.x);
                        pageRows.push(currentRow.map(c => c.text));
                    }

                    fullTableData = fullTableData.concat(pageRows);
                    fullTableData.push([]); // Empty row for spacing
                }

                if (!hasText) {
                    alert("⚠️ No Text Found! This looks like a scanned PDF (Image). This tool works with text-based PDFs.");
                    location.reload();
                    return;
                }

                // Generate Excel File
                const wb = XLSX.utils.book_new();
                const ws = XLSX.utils.aoa_to_sheet(fullTableData);
                
                // Set Column Widths
                ws['!cols'] = [{wch: 25}, {wch: 25}, {wch: 25}, {wch: 25}, {wch: 25}];

                XLSX.utils.book_append_sheet(wb, ws, "Converted Data");
                excelWorkbook = wb;

                // Show Success
                processingStep.classList.add('hidden');
                downloadStep.classList.remove('hidden');
                downloadStep.classList.add('animate-fade-in');

            } catch (error) {
                console.error(error);
                alert("Error processing PDF: " + error.message);
                location.reload();
            }
        });

        downloadBtn.addEventListener('click', function() {
            if(excelWorkbook) {
                XLSX.writeFile(excelWorkbook, `${originalFileName}_converted.xlsx`);
            }
        });
    </script>
</body>
</html>