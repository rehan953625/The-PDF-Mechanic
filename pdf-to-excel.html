<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <title>PDF to Excel Converter | Convert PDF to XLSX Free & Secure - The PDF Mechanic</title>
    <meta name="description" content="Convert PDF to Excel (XLSX) instantly. Extract tables and data from PDF documents to editable spreadsheets for free. 100% Client-side privacy - No file uploads." />
    <meta name="keywords" content="PDF to Excel, Convert PDF to Excel, PDF to XLSX, extract table from PDF, online PDF converter, PDF to Excel converter free, secure PDF tools, client-side PDF converter" />
    <meta name="author" content="The PDF Mechanic" />
    
    <meta property="og:title" content="PDF to Excel Converter - Free & Secure" />
    <meta property="og:description" content="Convert PDF tables to editable Excel spreadsheets directly in your browser. No file uploads required." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.thepdfmechanic.com/pdf-to-excel.html" />
    
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        tailwind.config = {
            theme: {
                extend: {
                    colors: { brand: '#217346', brandDark: '#15803d', bg: '#F3F4F6' },
                    fontFamily: { sans: ['Inter', 'sans-serif'] }
                }
            }
        }
    </script>
</head>
<body class="font-sans bg-bg text-gray-900 flex flex-col min-h-screen">

    <nav class="w-full bg-brand text-white shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
            <a href="index.html" class="font-bold text-xl flex items-center gap-2 hover:opacity-90 transition">
                <i class="fa-solid fa-file-excel"></i> The PDF Mechanic
            </a>
            <a href="index.html" class="text-sm bg-white/10 px-3 py-1 rounded hover:bg-white/20 transition">Back to Home</a>
        </div>
    </nav>

    <div class="bg-white border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 py-3">
            <nav class="flex text-sm text-gray-500">
                <ol class="inline-flex items-center space-x-1">
                    <li><a href="index.html" class="hover:text-brand">Home</a></li>
                    <li><i class="fa-solid fa-chevron-right text-xs mx-2"></i></li>
                    <li class="text-gray-800 font-medium">PDF to Excel</li>
                </ol>
            </nav>
        </div>
    </div>

    <main class="flex-grow max-w-5xl mx-auto px-4 py-12 w-full">
        
        <div class="text-center mb-10">
            <h1 class="text-4xl font-extrabold text-gray-900 mb-4">Convert PDF to Excel Online</h1>
            <p class="text-lg text-gray-600 max-w-2xl mx-auto">Turn your PDF data into editable Excel (XLSX) spreadsheets instantly. 100% Free and Private.</p>
        </div>

        <div class="bg-white rounded-2xl shadow-xl border-t-8 border-brand overflow-hidden">
            
            <div class="p-8 md:p-12">
                
                <div id="uploadArea" class="border-3 border-dashed border-gray-300 rounded-2xl p-12 text-center hover:bg-green-50 hover:border-brand transition duration-300 cursor-pointer group relative" onclick="document.getElementById('pdf-upload').click()">
                    <input type="file" id="pdf-upload" accept="application/pdf" class="hidden">
                    
                    <div class="absolute top-4 right-4 bg-green-100 text-brand text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wide">Free</div>

                    <div class="text-brand text-7xl mb-6 group-hover:scale-110 transition duration-300 drop-shadow-sm">
                        <i class="fa-solid fa-cloud-arrow-up"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-2">Select PDF File</h3>
                    <p class="text-gray-500">or drop PDF here</p>
                    <p class="mt-4 text-xs text-gray-400">Supports text-based PDFs (Invoices, Reports, Tables)</p>
                </div>

                <div id="processing" class="hidden text-center py-16">
                    <div class="animate-spin inline-block w-16 h-16 border-[6px] border-gray-200 border-t-brand rounded-full" role="status"></div>
                    <h3 class="text-2xl font-bold text-gray-800 mt-8">Extracting Data...</h3>
                    <p id="progress-text" class="text-gray-500 mt-2 text-lg">Analyzing pages...</p>
                </div>

                <div id="downloadArea" class="hidden text-center py-10">
                    <div class="w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6 animate-bounce">
                        <i class="fa-solid fa-check text-5xl text-brand"></i>
                    </div>
                    <h3 class="text-3xl font-bold text-gray-800 mb-2">Conversion Successful!</h3>
                    <p class="text-gray-600 mb-8 text-lg">Your data has been extracted to Excel.</p>
                    
                    <button id="download-btn" class="bg-brand text-white px-10 py-4 rounded-xl font-bold text-xl hover:bg-brandDark shadow-lg transform transition hover:-translate-y-1 flex items-center gap-3 mx-auto">
                        <i class="fa-solid fa-file-excel"></i> Download Excel File
                    </button>
                    
                    <button onclick="location.reload()" class="mt-8 text-gray-500 font-medium hover:text-brand underline flex items-center justify-center gap-2 mx-auto">
                        <i class="fa-solid fa-rotate-right"></i> Convert Another File
                    </button>
                </div>
            </div>

            <div class="bg-gray-50 p-4 border-t border-gray-100 flex justify-center items-center gap-6 text-sm text-gray-500 flex-wrap">
                <span class="flex items-center gap-2"><i class="fa-solid fa-shield-halved text-brand"></i> Secure Client-Side Processing</span>
                <span class="flex items-center gap-2"><i class="fa-solid fa-bolt text-brand"></i> Instant Conversion</span>
                <span class="flex items-center gap-2"><i class="fa-solid fa-ban text-brand"></i> No Server Uploads</span>
            </div>
        </div>

    </main>

    <section class="bg-white py-16 border-t border-gray-200">
        <div class="max-w-6xl mx-auto px-4">
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-12 mb-16">
                <div>
                    <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center gap-2">
                        <i class="fa-solid fa-list-ol text-brand"></i> How to Use?
                    </h2>
                    <ol class="space-y-4">
                        <li class="flex gap-4 items-start">
                            <span class="bg-green-100 text-brand font-bold w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0">1</span>
                            <div>
                                <h4 class="font-bold text-gray-800">Upload PDF</h4>
                                <p class="text-gray-600 text-sm">Click the box to select your PDF file containing tables or lists.</p>
                            </div>
                        </li>
                        <li class="flex gap-4 items-start">
                            <span class="bg-green-100 text-brand font-bold w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0">2</span>
                            <div>
                                <h4 class="font-bold text-gray-800">Wait for Processing</h4>
                                <p class="text-gray-600 text-sm">Our tool scans the text structure to identify rows and columns automatically.</p>
                            </div>
                        </li>
                        <li class="flex gap-4 items-start">
                            <span class="bg-green-100 text-brand font-bold w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0">3</span>
                            <div>
                                <h4 class="font-bold text-gray-800">Download Excel</h4>
                                <p class="text-gray-600 text-sm">Save the converted .xlsx file to your device instantly.</p>
                            </div>
                        </li>
                    </ol>
                </div>

                <div>
                    <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center gap-2">
                        <i class="fa-solid fa-gears text-brand"></i> How It Works
                    </h2>
                    <p class="text-gray-700 leading-relaxed mb-4">
                        Unlike traditional converters that just copy text, <strong>The PDF Mechanic</strong> uses a smart coordinate-based algorithm.
                    </p>
                    <p class="text-gray-700 leading-relaxed">
                        It reads the X and Y positions of every text element on your PDF page. By analyzing vertical alignment (for columns) and horizontal alignment (for rows), it reconstructs the table structure into a spreadsheet format compatible with Microsoft Excel, Google Sheets, and LibreOffice.
                    </p>
                </div>
            </div>

            <div class="border-t border-gray-200 pt-12">
                <h2 class="text-3xl font-bold text-center text-gray-900 mb-10">Frequently Asked Questions</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    
                    <details class="group bg-gray-50 p-6 rounded-xl border border-gray-200 cursor-pointer transition hover:shadow-md">
                        <summary class="flex justify-between items-center font-bold text-gray-800">
                            Is this PDF to Excel tool free?
                            <span class="text-brand transition group-open:rotate-180"><i class="fa-solid fa-chevron-down"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-3 text-sm leading-relaxed">Yes, absolutely. You can convert as many files as you want without any cost or subscription.</p>
                    </details>

                    <details class="group bg-gray-50 p-6 rounded-xl border border-gray-200 cursor-pointer transition hover:shadow-md">
                        <summary class="flex justify-between items-center font-bold text-gray-800">
                            Is my data safe?
                            <span class="text-brand transition group-open:rotate-180"><i class="fa-solid fa-chevron-down"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-3 text-sm leading-relaxed">Yes. We use <strong>Client-side Processing</strong>. Your file is processed by your own browser and never uploaded to any external server. Your financial or personal data stays on your device.</p>
                    </details>

                    <details class="group bg-gray-50 p-6 rounded-xl border border-gray-200 cursor-pointer transition hover:shadow-md">
                        <summary class="flex justify-between items-center font-bold text-gray-800">
                            Does it work with Scanned PDFs?
                            <span class="text-brand transition group-open:rotate-180"><i class="fa-solid fa-chevron-down"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-3 text-sm leading-relaxed">Currently, this tool works best with <strong>Native PDFs</strong> (files where you can select text). Scanned images require OCR technology, which we are working on adding soon.</p>
                    </details>

                    <details class="group bg-gray-50 p-6 rounded-xl border border-gray-200 cursor-pointer transition hover:shadow-md">
                        <summary class="flex justify-between items-center font-bold text-gray-800">
                            Can I edit the Excel file after conversion?
                            <span class="text-brand transition group-open:rotate-180"><i class="fa-solid fa-chevron-down"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-3 text-sm leading-relaxed">Yes! The output is a standard <code>.xlsx</code> file. You can open it in Microsoft Excel, Google Sheets, or WPS Office and edit cells, formulas, and formatting freely.</p>
                    </details>

                    <details class="group bg-gray-50 p-6 rounded-xl border border-gray-200 cursor-pointer transition hover:shadow-md">
                        <summary class="flex justify-between items-center font-bold text-gray-800">
                            Does it support multi-page PDFs?
                            <span class="text-brand transition group-open:rotate-180"><i class="fa-solid fa-chevron-down"></i></span>
                        </summary>
                        <p class="text-gray-600 mt-3 text-sm leading-relaxed">Yes. If your PDF has multiple pages of tables (like a bank statement), our tool will extract data from all pages and combine them into the Excel sheet.</p>
                    </details>

                </div>
            </div>

        </div>
    </section>

    <footer class="bg-gray-900 text-white pt-16 pb-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-12">
                
                <div class="col-span-1 md:col-span-1">
                    <h3 class="text-2xl font-bold mb-4">The PDF Mechanic</h3>
                    <p class="text-gray-400 text-sm leading-relaxed">
                        Secure, privacy-focused online PDF tools. Process your documents locally without uploading them to servers.
                    </p>
                </div>

                <div>
                    <h4 class="text-lg font-semibold mb-4 text-gray-200 border-b border-gray-700 pb-2">Convert</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="pdf-to-word.html" class="hover:text-brand transition">PDF to Word</a></li>
                        <li><a href="pdf-to-excel.html" class="text-white font-bold">PDF to Excel</a></li>
                        <li><a href="images-to-pdf.html" class="hover:text-brand transition">JPG to PDF</a></li>
                        <li><a href="pdf-to-images.html" class="hover:text-brand transition">PDF to JPG</a></li>
                    </ul>
                </div>

                <div>
                    <h4 class="text-lg font-semibold mb-4 text-gray-200 border-b border-gray-700 pb-2">Organize</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="merger.html" class="hover:text-brand transition">Merge PDF</a></li>
                        <li><a href="splitter.html" class="hover:text-brand transition">Split PDF</a></li>
                        <li><a href="delete-pages.html" class="hover:text-brand transition">Delete Pages</a></li>
                        <li><a href="reorder-pages.html" class="hover:text-brand transition">Reorder Pages</a></li>
                    </ul>
                </div>

                <div>
                    <h4 class="text-lg font-semibold mb-4 text-gray-200 border-b border-gray-700 pb-2">Edit & Sign</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="compressor.html" class="hover:text-brand transition">Compress PDF</a></li>
                        <li><a href="pdf-editor.html" class="hover:text-brand transition">PDF Editor</a></li>
                        <li><a href="esign.html" class="hover:text-brand transition">eSign PDF</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="border-t border-gray-800 pt-8 text-center text-sm text-gray-500 flex flex-col md:flex-row justify-between items-center gap-4">
                <p>Â© <span id="year"></span> The PDF Mechanic. All rights reserved.</p>
                <div class="flex gap-4">
                    <a href="#" class="hover:text-white transition">Privacy Policy</a>
                    <a href="#" class="hover:text-white transition">Terms of Use</a>
                    <a href="#" class="hover:text-white transition">Contact</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        document.getElementById('year').textContent = new Date().getFullYear();

        const pdfUpload = document.getElementById('pdf-upload');
        const uploadArea = document.getElementById('uploadArea');
        const processing = document.getElementById('processing');
        const downloadArea = document.getElementById('downloadArea');
        const downloadBtn = document.getElementById('download-btn');
        const progressText = document.getElementById('progress-text');

        let workbookBlob = null;

        pdfUpload.addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;

            // UI Switch
            uploadArea.classList.add('hidden');
            processing.classList.remove('hidden');

            try {
                const arrayBuffer = await file.arrayBuffer();
                const pdf = await pdfjsLib.getDocument(arrayBuffer).promise;
                
                const totalPages = pdf.numPages;
                let fullData = [];

                // Iterate pages
                for (let i = 1; i <= totalPages; i++) {
                    progressText.innerText = `Processing page ${i} of ${totalPages}...`;
                    
                    const page = await pdf.getPage(i);
                    const textContent = await page.getTextContent();
                    
                    // Logic to reconstruct table
                    const items = textContent.items.map(item => ({
                        str: item.str,
                        x: item.transform[4], // X coordinate
                        y: item.transform[5], // Y coordinate
                        h: item.height
                    }));

                    // Sort by Y (Top to Bottom), then X (Left to Right)
                    const toleranceY = 5; 
                    items.sort((a, b) => {
                        const diffY = Math.abs(b.y - a.y); // Compare Y (inverted)
                        if (diffY < toleranceY) {
                            return a.x - b.x; // Same line, sort left to right
                        }
                        return b.y - a.y; // Different lines, sort top down
                    });

                    // Group into rows
                    let rows = [];
                    let currentRow = [];
                    let lastY = -9999;

                    items.forEach(item => {
                        if (!item.str.trim()) return;

                        if (lastY === -9999 || Math.abs(item.y - lastY) < toleranceY) {
                            currentRow.push(item.str);
                            lastY = item.y;
                        } else {
                            if (currentRow.length > 0) rows.push(currentRow);
                            currentRow = [item.str];
                            lastY = item.y;
                        }
                    });
                    if (currentRow.length > 0) rows.push(currentRow);

                    // Add empty row between pages
                    if (fullData.length > 0) fullData.push([]);
                    fullData = fullData.concat(rows);
                }

                // Create Workbook using SheetJS
                progressText.innerText = "Generating Excel file...";
                
                const wb = XLSX.utils.book_new();
                const ws = XLSX.utils.aoa_to_sheet(fullData);
                XLSX.utils.book_append_sheet(wb, ws, "PDF Data");
                
                const wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });
                workbookBlob = new Blob([wbout], { type: 'application/octet-stream' });

                // Show Download
                processing.classList.add('hidden');
                downloadArea.classList.remove('hidden');

            } catch (error) {
                console.error(error);
                alert("Error: " + error.message);
                location.reload();
            }
        });

        downloadBtn.addEventListener('click', () => {
            if (!workbookBlob) return;
            const url = window.URL.createObjectURL(workbookBlob);
            const a = document.createElement('a');
            a.href = url;
            a.download = "converted_spreadsheet.xlsx";
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
        });
    </script>
</body>
</html>